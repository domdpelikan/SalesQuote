<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Sales Quote</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f3f4f6;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .page-container { width: 100%; max-width: 900px; }
        .main-card { background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); overflow: hidden; }
        .card-header { background: linear-gradient(135deg, #2d7a7f 0%, #1f5a5e 100%); color: white; padding: 32px; text-align: center; }
        .card-header h1 { font-size: 32px; font-weight: 700; margin-bottom: 8px; letter-spacing: -0.5px; }
        .card-header h2 { font-size: 18px; font-weight: 400; opacity: 0.95; color: #f39237; }
        .card-content { padding: 32px; }
        section { margin-bottom: 32px; }
        section:last-child { margin-bottom: 0; }
        h3 { font-size: 18px; font-weight: 600; color: #1f2937; margin-bottom: 16px; }
        .item-info p { font-size: 15px; color: #4b5563; margin-bottom: 8px; line-height: 1.6; }
        .item-info strong { color: #1f2937; font-weight: 600; }
        .divider { border: none; border-top: 1px solid #e5e7eb; margin: 32px 0; }
        .form-group { margin-bottom: 20px; }
        .price-group { display: flex; gap: 20px; }
        .price-group .form-group { flex: 1; }
        label { display: block; font-weight: 600; color: #374151; margin-bottom: 8px; font-size: 14px; }
        input[type="text"], input[type="search"], select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            transition: all 0.2s;
            background: white;
        }
        textarea { resize: vertical; }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #2d7a7f;
            box-shadow: 0 0 0 3px rgba(45, 122, 127, 0.1);
        }
        input::placeholder, textarea::placeholder { color: #9ca3af; }
        button {
            background: linear-gradient(135deg, #2d7a7f 0%, #1f5a5e 100%);
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.2s;
        }
        button:hover { transform: translateY(-1px); }
        button:disabled { background: #9ca3af; cursor: not-allowed; box-shadow: none; }
        #formMessage { margin-top: 16px; padding: 12px; border-radius: 8px; font-size: 14px; text-align: center; display: none; }
        #formMessage.success { background: #d1fae5; color: #065f46; border: 1px solid #6ee7b7; display: block; }
        #formMessage.error { background: #fee2e2; color: #991b1b; border: 1px solid #fca5a5; display: block; }
        .history-container { background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; padding: 16px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        thead { background: #f3f4f6; }
        th { text-align: left; padding: 12px; font-weight: 600; color: #374151; font-size: 14px; border-bottom: 2px solid #e5e7eb; }
        td { padding: 12px; color: #4b5563; font-size: 14px; border-bottom: 1px solid #e5e7eb; vertical-align: middle; }
        .price-cell { min-width: 120px; }
        .notes-cell button { font-size: 14px; color: #2d7a7f; background: none; border: none; padding: 4px; cursor: pointer; font-weight: 600; }
        .notes-cell button:hover { text-decoration: underline; }
        tbody tr:last-child td { border-bottom: none; }
        #searchHistoryTable tbody tr:hover { background: #f0f9ff; cursor: pointer; } 
        .no-history-message { display: none; text-align: center; padding: 32px; color: #9ca3af; font-size: 15px; }
        
        .action-button { background: none; border: none; cursor: pointer; padding: 4px; border-radius: 50%; }
        .action-button:hover { background-color: #e5e7eb; }
        .action-button svg { width: 20px; height: 20px; color: #6b7280; }

        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.6); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .modal-overlay.visible { opacity: 1; pointer-events: auto; }
        .modal-content { background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); width: 90%; max-width: 500px; transform: scale(0.95); transition: transform 0.3s ease; }
        .modal-overlay.visible .modal-content { transform: scale(1); }
        .modal-header { padding: 20px; border-bottom: 1px solid #e5e7eb; }
        .modal-header h4 { font-size: 18px; font-weight: 600; }
        .modal-body { padding: 20px; }
        .modal-footer { padding: 15px 20px; border-top: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; }
        .modal-footer .btn-secondary { background: #e5e7eb; color: #374151; }
        .modal-footer .btn-danger { background: #ef4444; color: white; }
        .modal-footer .btn-primary { background: #2d7a7f; color: white; }

        @media (max-width: 640px) {
            .card-header h1 { font-size: 24px; }
            .card-header h2 { font-size: 16px; }
            .card-content { padding: 24px; }
            th, td { padding: 8px; font-size: 13px; }
            .price-group { flex-direction: column; gap: 0; }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="main-card">
            <header class="card-header">
                <h1>iMED ALL inc.</h1>
                <h2>Sales Quote</h2>
            </header>
            <div class="card-content">
                <section class="item-info">
                    <h3>Item Details</h3>
                    <p><strong>Name:</strong> <span id="itemName">Loading...</span></p>
                    <p><strong>Part Number:</strong> <span id="partNumber">...</span></p>
                </section>

                
                <hr class="divider">

                <section class="quote-form">
                    <h3>Create New Quote</h3>
                    <form id="newQuoteForm">
                        <div class="form-group">
                            <label for="customer">Sold:</label>
                            <select id="customer" name="customer" required>
                                <option value="" disabled selected>Loading Customers...</option>
                            </select>
                        </div>
                        <div class="price-group">
                            <div class="form-group">
                                <label for="outrightPrice">Outright Quote ($):</label>
                                <input type="text" id="outrightPrice" name="outrightPrice" placeholder="e.g., 2,000.00">
                            </div>
                            <div class="form-group">
                                <label for="exchangePrice">Exchange Quote ($):</label>
                                <input type="text" id="exchangePrice" name="exchangePrice" placeholder="e.g., 1,500.00">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="status">Status:</label>
                            <select id="status" name="status" required>
                                <option value="Quoted">Quoted</option>
                                <option value="Sold at Quoted Price Outright">Sold at Quoted Price Outright</option>
                                <option value="Sold at Quoted Price Exchange">Sold at Quoted Price Exchange</option>
                                <option value="Lost Sale">Lost Sale</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="notes">Notes:</label>
                            <textarea id="notes" name="notes" rows="3" placeholder="Add any internal notes for this quote..."></textarea>
                        </div>
                        <button type="submit" id="submitButton">Save Quote</button>
                    </form>
                    <p id="formMessage"></p>
                </section>
                
                <hr class="divider">

                <section class="quote-history">
                    <h3>Quote History for this Part (Latest 10)</h3>
                    <div class="history-container">
                        <table id="historyTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Sold</th>
                                    <th class="price-cell">Outright</th>
                                    <th class="price-cell">Exchange</th>
                                    <th>Status</th>
                                    <th>Notes</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="historyBody"></tbody>
                        </table>
                        <p id="noHistoryMessage" class="no-history-message">No quote history found for this part.</p>
                    </div>
                </section>

                <hr class="divider">
                <section class="sales-history-graph">
                    <h3>Sales History Graph</h3>
                    <div class="history-container">
                        <canvas id="salesHistoryChart"></canvas>
                        <p id="noSalesDataMessage" class="no-history-message" style="display: none;">No sales history available for this part.</p>
                    </div>
                </section>

                <hr class="divider">

                <section class="searchable-quote-history">
                    <h3>Search All Quotes</h3>
                    <div class="form-group">
                        <input type="search" id="quoteSearchInput" placeholder="Search by PN, Sold To, or Item Name...">
                    </div>
                    <div class="form-group" style="display: flex; justify-content: space-between; align-items: center; gap: 16px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <label for="resultsLimit" style="margin: 0; font-size: 14px;">Show:</label>
                            <select id="resultsLimit" style="width: auto; padding: 8px 12px;">
                                <option value="25">25 results</option>
                                <option value="50">50 results</option>
                                <option value="all">All results</option>
                            </select>
                        </div>
                        <button id="generatePdfButton" type="button" style="width: auto; padding: 10px 24px; font-size: 14px;" disabled>
                            Generate PDF (<span id="selectedCount">0</span> selected)
                        </button>
                    </div>
                    <div class="history-container">
                        <table id="searchHistoryTable">
                            <thead>
                                <tr>
                                    <th style="width: 40px;">
                                        <input type="checkbox" id="selectAllCheckbox" style="cursor: pointer;">
                                    </th>
                                    <th>Date</th>
                                    <th>PN</th>
                                    <th>Sold</th>
                                    <th class="price-cell">Outright</th>
                                    <th class="price-cell">Exchange</th>
                                    <th>Status</th>
                                    <th>Notes</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="searchHistoryBody"></tbody>
                        </table>
                        <p id="noSearchResultsMessage" class="no-history-message">Type in the search bar to find quotes.</p>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Edit Modal HTML -->
    <div id="editModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Edit Quote</h4>
            </div>
            <div class="modal-body">
                <form id="editQuoteForm">
                    <input type="hidden" id="editQuoteId">
                    <div class="form-group">
                        <label for="editSoldTo">Sold:</label>
                        <select id="editSoldTo" name="sold" required></select>
                    </div>
                    <div class="price-group">
                        <div class="form-group">
                            <label for="editOutrightPrice">Outright Quote ($):</label>
                            <input type="text" id="editOutrightPrice" name="outrightPrice">
                        </div>
                        <div class="form-group">
                            <label for="editExchangePrice">Exchange Quote ($):</label>
                            <input type="text" id="editExchangePrice" name="exchangePrice">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editStatus">Status:</label>
                        <select id="editStatus" name="status" required>
                            <option value="Quoted">Quoted</option>
                            <option value="Sold at Quoted Price Outright">Sold at Quoted Price Outright</option>
                            <option value="Sold at Quoted Price Exchange">Sold at Quoted Price Exchange</option>
                            <option value="Lost Sale">Lost Sale</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editNotes">Notes:</label>
                        <textarea id="editNotes" name="notes" rows="4"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="deleteQuoteButton" class="btn-danger">Delete</button>
                <div>
                    <button type="button" id="cancelEditButton" class="btn-secondary">Cancel</button>
                    <button type="button" id="saveEditButton" class="btn-primary">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
    <script>
        // --- START CONFIGURATION ---
        const firebaseConfig = {
          apiKey: "AIzaSyCe0u6B6qA9y6xvSR_jbY1Do-ljPKy5Lu8",
          authDomain: "imed-sales-quote.firebaseapp.com",
          databaseURL: "https://imed-sales-quote-default-rtdb.firebaseio.com",
          projectId: "imed-sales-quote",
          storageBucket: "imed-sales-quote.firebasestorage.app",
          messagingSenderId: "830326754595",
          appId: "1:830326754595:web:ca03272749599736fad096",
          measurementId: "G-6TCTDFX5PL"
        };
        
        const APPSHEET_CONFIG = {
            API_KEY: "V2-p5nLK-I6suM-yAVyE-bhP5n-TaFuq-uDBbY-vjvr0-8RoEu",
            APP_ID: "876dcdc3-0570-427f-9be0-53367d74bf69",
            TABLE_NAME: "Siemens Stock",
            CUSTOMER_COLUMN: "Sold"
        };
        
        // ADD YOUR LOGO BASE64 HERE
        const IMED_LOGO_BASE64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB4AAAAQ4CAYAAADo08FDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE2mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA5LTEwPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmZmMzZiNGYzLWY3YmItNDNmYy04NTQzLWJlOTk3YzQzNDlhYTwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5pTUVEIERQIExvZ28gTmV3IC0gMTwvcmRmOmxpPgogICA8L3JkZjpBbHQ+CiAgPC9kYzp0aXRsZT4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6cGRmPSdodHRwOi8vbnMuYWRvYmUuY29tL3BkZi8xLjMvJz4KICA8cGRmOkF1dGhvcj5Eb21pbmlrIFBlbGlrYW48L3BkZjpBdXRob3I+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0nJwogIHhtbG5zOnhtcD0naHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyc+CiAgPHhtcDpDcmVhdG9yVG9vbD5DYW52YSAoUmVuZGVyZXIpIGRvYz1EQUd5bTZjTUcxWSB1c2VyPVVBR2NCc1BwX3M0IGJyYW5kPUNhbGlmb3JuaWEgU3RhdGUgVW5pdmVyc2l0eSwgRnVsbGVydG9uIHRlbXBsYXRlPTwveG1wOkNyZWF0b3JUb29sPgogPC9yZGY6RGVzY3JpcHRpb24+CjwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9J3InPz5ZdJdfAACFBElEQVR4nOzZQQkAMAzAwNa/6ZoYDMKdgvyzAwAAAAAAAEDC/g4AAAAAAAAA4A0DGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgAgDGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgAgDGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgAgDGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgAgDGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgAgDGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgAgDGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgAgDGAAAAAAAACDCAAYAAAAAAACIMIABAAAAAAAAIgxgAAAAAAAAgIgDAAD//+zZgQwAAADAIH/re3ylkQAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYCIAAAD//+zZgQwAAADAIH/re3ylkQAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYCIAAAD//+zZgQwAAADAIH/re3ylkQAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYCIAAAD//+zZgQwAAADAIH/re3ylkQAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYCIAAAD//+zZgQwAAADAIH/re3ylkQAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYCIAAAD//+zZgQwAAADAIH/re3ylkQAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwEAAP//7NmBDAAAAMAgf+t7fKWRAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgIgAAAP//7NmBDAAAAMAgf+t7fKWRAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAA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ACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgIgAAAP//7NmBDAAAAMAgf+t7fKWRAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgIgAAAP//7NmBDAAAAMAgf+t7fKWRAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAQAA///s2YEMAAAAwCB/63t8pZEABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGAiAAAA///s2YEMAAAAwCB/63t8pZEABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGAiAAAA///s2YEMAAAAwCB/63t8pZEABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGAiAAAA///s2YEMAAAAwCB/63t8pZEABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGAiAAAA///s2YEMAAAAwCB/63t8pZEABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGAiAAAA///t2YEMAAAAwCB/63t8pZEABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGBCAAMAAAAAAABMCGAAAAAAAACACQEMAAAAAAAAMCGAAQAAAAAAACYEMAAAAAAAAMCEAAYAAAAAAACYEMAAAAAAAAAAEwIYAAAAAAAAYEIAAwAAAAAAAEwIYAAAAAAAAIAJAQwAAAAAAAAwIYABAAAAAAAAJgQwAAAAAAAAwIQABgAAAAAAAJgQwAAAAAAAAAATAhgAAAAAAABgQgADAAAAAAAATAhgAAAAAAAAgAkBDAAAAAAAADAhgAEAAAAAAAAmBDAAAAAAAADAhAAGAAAAAAAAmBDAAAAAAAAAABMCGAAAAAAAAGAidryI0BmCo1IAAAAASUVORK5CYII=';
        // --- END CONFIGURATION ---

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        let allQuotesCache = [];
        let soldListCache = [];
        let salesHistoryChart; 
        let currentHistoryListener = null;
        let selectedQuotes = new Set();
        let currentResultsLimit = 25;

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const initialPartNumber = urlParams.get('pn');
            const initialItemName = urlParams.get('name');
            
            if (!initialPartNumber) { 
                document.getElementById('itemName').textContent = 'N/A';
                document.getElementById('partNumber').textContent = 'N/A';
                return; 
            }
            
            updateMainView(initialPartNumber, initialItemName);
            fetchCustomersFromAppSheet();
            fetchAllQuotesForSearch();
            checkAndExpireQuotes(); 

            // Event Listeners
            document.getElementById('newQuoteForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('quoteSearchInput').addEventListener('input', (e) => filterAndDisplayQuotes(e.target.value));
            document.getElementById('resultsLimit').addEventListener('change', handleResultsLimitChange);
            document.getElementById('selectAllCheckbox').addEventListener('change', handleSelectAll);
            document.getElementById('generatePdfButton').addEventListener('click', generatePDF);
            
            ['outrightPrice', 'exchangePrice', 'editOutrightPrice', 'editExchangePrice'].forEach(id => {
                document.getElementById(id).addEventListener('input', handleCurrencyInput);
                document.getElementById(id).addEventListener('blur', handleCurrencyBlur);
            });

            document.getElementById('cancelEditButton').addEventListener('click', closeEditModal);
            document.getElementById('saveEditButton').addEventListener('click', handleEditFormSubmit);
            document.getElementById('deleteQuoteButton').addEventListener('click', handleDeleteQuote);
            document.getElementById('editModal').addEventListener('click', (e) => {
                if (e.target.id === 'editModal') closeEditModal();
            });

            document.body.addEventListener('click', (e) => {
                const actionButton = e.target.closest('[data-action]');
                if (actionButton) {
                    const action = actionButton.dataset.action;
                    const quote = JSON.parse(actionButton.dataset.quote || '{}');

                    if (action === 'edit-quote') {
                        openEditModal(quote);
                    } else if (action === 'view-notes') {
                        alert(quote.notes || 'No notes for this quote.');
                    }
                    return;
                }

                const searchRow = e.target.closest('#searchHistoryBody tr');
                if (searchRow) {
                    if (e.target.closest('select, button, input[type="checkbox"]')) {
                        return;
                    }

                    const pn = searchRow.dataset.pn;
                    const itemName = searchRow.dataset.itemName;
                    if (pn && itemName) {
                        updateMainView(pn, itemName);
                        window.scrollTo(0, 0);
                    }
                }
            });
        });
        
        function updateMainView(pn, itemName) {
            document.getElementById('itemName').textContent = itemName || 'N/A';
            document.getElementById('partNumber').textContent = pn || 'N/A';
            
            if (currentHistoryListener) {
                currentHistoryListener.off();
            }
            listenForQuoteHistory(pn);
        }

        async function fetchCustomersFromAppSheet() {
            const customerSelect = document.getElementById('customer');
            const encodedTableName = encodeURIComponent(APPSHEET_CONFIG.TABLE_NAME);
            const API_URL = `https://api.appsheet.com/api/v2/apps/${APPSHEET_CONFIG.APP_ID}/tables/${encodedTableName}/Action`;
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'ApplicationAccessKey': APPSHEET_CONFIG.API_KEY },
                    body: JSON.stringify({ "Action": "Find", "Properties": {}, "Rows": [] })
                });
                if (!response.ok) throw new Error(`Failed to fetch customers: ${response.statusText}`);
                const data = await response.json();
                customerSelect.innerHTML = '<option value="" disabled selected>Select from Sold List...</option>';
                const customerNames = new Set();
                if (Array.isArray(data)) {
                    data.forEach(item => {
                        const customerName = item[APPSHEET_CONFIG.CUSTOMER_COLUMN];
                        if (customerName && customerName.trim() !== '') customerNames.add(customerName.trim());
                    });
                }
                soldListCache = Array.from(customerNames).sort();
                soldListCache.forEach(name => {
                    const option = document.createElement('option');
                    option.value = name; 
                    option.textContent = name;
                    customerSelect.appendChild(option.cloneNode(true));
                });
            } catch (error) {
                console.error("Error fetching customers:", error);
                customerSelect.innerHTML = '<option value="" disabled>Error loading customers</option>';
            }
        }
        
        function formatPrice(price) {
            const num = parseFloat(price);
            if (isNaN(num)) return '—';
            return `$${num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }
        
        function handleCurrencyInput(event) {
            const input = event.target; let value = input.value; let cursorPosition = input.selectionStart;
            const commasBefore = (value.substring(0, cursorPosition).match(/,/g) || []).length;
            let numericValue = value.replace(/[^0-9.]/g, '');
            const parts = numericValue.split('.');
            if (parts.length > 2) numericValue = parts[0] + '.' + parts.slice(1).join('');
            const [integerPart, decimalPart] = numericValue.split('.');
            const formattedInteger = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            let finalValue = formattedInteger;
            if (decimalPart !== undefined) finalValue += '.' + decimalPart.substring(0, 2);
            input.value = finalValue;
            const commasAfter = (input.value.substring(0, cursorPosition).match(/,/g) || []).length;
            cursorPosition += (commasAfter - commasBefore);
            if(cursorPosition < 0) cursorPosition = 0;
            input.setSelectionRange(cursorPosition, cursorPosition);
        }
        
        function handleCurrencyBlur(event) {
            const input = event.target; let value = input.value; if (value === '') return;
            const numericValue = parseFloat(value.replace(/,/g, ''));
            if (!isNaN(numericValue)) { input.value = numericValue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }); } 
            else { input.value = ''; }
        }

        function renderHistoryTable(tableBody, quotes, includePn = false) {
            tableBody.innerHTML = '';
            quotes.forEach(quote => {
                const row = tableBody.insertRow();
                if (includePn) {
                    row.dataset.pn = quote.pn || '';
                    row.dataset.itemName = quote.itemName || '';
                }
                const quoteData = JSON.stringify(quote).replace(/'/g, "&apos;");
                const isChecked = selectedQuotes.has(quote.id);
                let cells = `
                    ${includePn ? `<td><input type="checkbox" class="quote-checkbox" data-quote-id="${quote.id}" ${isChecked ? 'checked' : ''} style="cursor: pointer;"></td>` : ''}
                    <td>${new Date(quote.date).toLocaleDateString()}</td>
                    ${includePn ? `<td>${quote.pn || 'N/A'}</td>` : ''}
                    <td>${quote.sold || 'N/A'}</td>
                    <td class="price-cell">${formatPrice(quote.outrightPrice)}</td>
                    <td class="price-cell">${formatPrice(quote.exchangePrice)}</td>
                    <td><select class="status-select" onchange="handleStatusChange(event, '${quote.id}')">
                        <option value="Quoted" ${quote.status === 'Quoted' ? 'selected' : ''}>Quoted</option>
                        <option value="Sold at Quoted Price Outright" ${quote.status === 'Sold at Quoted Price Outright' ? 'selected' : ''}>Sold Outright</option>
                        <option value="Sold at Quoted Price Exchange" ${quote.status === 'Sold at Quoted Price Exchange' ? 'selected' : ''}>Sold Exchange</option>
                        <option value="Lost Sale" ${quote.status === 'Lost Sale' ? 'selected' : ''}>Lost Sale</option>
                    </select></td>
                    <td class="notes-cell">
                        ${quote.notes ? `<button data-action="view-notes" data-quote='${quoteData}'>View</button>` : '—'}
                    </td>
                    <td>
                        <button class="action-button" data-action="edit-quote" data-quote='${quoteData}'>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm.75 0a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm4.5.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0-.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Zm3.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0-.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z" /></svg>
                        </button>
                    </td>
                `;
                row.innerHTML = cells;
            });
            
            if (includePn) {
                document.querySelectorAll('.quote-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', handleCheckboxChange);
                });
            }
        }

        function listenForQuoteHistory(pn) {
            const quotesRef = database.ref('quotes').orderByChild('pn').equalTo(pn);
            currentHistoryListener = quotesRef;
            
            quotesRef.on('value', (snapshot) => {
                const historyBody = document.getElementById('historyBody');
                const noHistoryMessage = document.getElementById('noHistoryMessage');
                let quotes = [];
                if (snapshot.exists()) {
                    noHistoryMessage.style.display = 'none';
                    snapshot.forEach(childSnapshot => { quotes.push({ id: childSnapshot.key, ...childSnapshot.val() }); });
                    const sortedQuotes = quotes.sort((a, b) => new Date(b.date) - new Date(a.date));
                    const latest10 = sortedQuotes.slice(0, 10);
                    renderHistoryTable(historyBody, latest10);
                } else {
                    historyBody.innerHTML = ''; noHistoryMessage.style.display = 'block';
                }
                renderSalesHistoryGraph(quotes);
            });
        }

        async function handleFormSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const outrightPriceValue = formData.get('outrightPrice').replace(/,/g, '');
            const exchangePriceValue = formData.get('exchangePrice').replace(/,/g, '');
            const newQuote = {
                pn: document.getElementById('partNumber').textContent,
                itemName: document.getElementById('itemName').textContent,
                sold: formData.get('customer'),
                outrightPrice: outrightPriceValue ? parseFloat(outrightPriceValue) : null,
                exchangePrice: exchangePriceValue ? parseFloat(exchangePriceValue) : null,
                status: formData.get('status'),
                notes: formData.get('notes'),
                date: new Date().toISOString()
            };
            const messageEl = document.getElementById('formMessage');
            const submitButton = document.getElementById('submitButton');
            submitButton.disabled = true; submitButton.textContent = 'Saving...';
            try {
                await database.ref('quotes').push(newQuote);
                messageEl.textContent = 'Quote saved successfully!'; messageEl.className = 'success'; form.reset(); 
            } catch (error) {
                messageEl.textContent = `Error: ${error.message}`; messageEl.className = 'error';
            } finally {
                setTimeout(() => {
                    messageEl.textContent = ''; messageEl.className = '';
                    submitButton.disabled = false; submitButton.textContent = 'Save Quote';
                }, 2000);
            }
        }

        function fetchAllQuotesForSearch() {
            const quotesRef = database.ref('quotes');
            quotesRef.on('value', (snapshot) => {
                const quotes = snapshot.val();
                if (quotes) {
                    allQuotesCache = Object.keys(quotes).map(key => ({ id: key, ...quotes[key] })).sort((a, b) => new Date(b.date) - new Date(a.date));
                    const displayQuotes = getQuotesToDisplay();
                    renderHistoryTable(document.getElementById('searchHistoryBody'), displayQuotes, true);
                } else { 
                    allQuotesCache = [];
                    document.getElementById('searchHistoryBody').innerHTML = '';
                }
                const searchTerm = document.getElementById('quoteSearchInput').value;
                if (searchTerm) filterAndDisplayQuotes(searchTerm);
            });
        }

        function getQuotesToDisplay() {
            if (currentResultsLimit === 'all') {
                return allQuotesCache;
            }
            return allQuotesCache.slice(0, parseInt(currentResultsLimit));
        }

        function handleResultsLimitChange(event) {
            currentResultsLimit = event.target.value;
            const searchTerm = document.getElementById('quoteSearchInput').value;
            if (searchTerm) {
                filterAndDisplayQuotes(searchTerm);
            } else {
                const displayQuotes = getQuotesToDisplay();
                renderHistoryTable(document.getElementById('searchHistoryBody'), displayQuotes, true);
                document.getElementById('noSearchResultsMessage').style.display = allQuotesCache.length === 0 ? 'block' : 'none';
            }
        }

        function filterAndDisplayQuotes(searchTerm) {
            const searchHistoryBody = document.getElementById('searchHistoryBody');
            const noResultsMessage = document.getElementById('noSearchResultsMessage');
            if (!searchTerm) {
                const displayQuotes = getQuotesToDisplay();
                renderHistoryTable(searchHistoryBody, displayQuotes, true);
                noResultsMessage.textContent = 'Type in the search bar to find quotes.';
                noResultsMessage.style.display = allQuotesCache.length === 0 ? 'block' : 'none';
                return;
            }
            const lowerCaseSearchTerm = searchTerm.toLowerCase();
            const filteredQuotes = allQuotesCache.filter(q => 
                (q.pn && q.pn.toLowerCase().includes(lowerCaseSearchTerm)) || 
                (q.sold && q.sold.toLowerCase().includes(lowerCaseSearchTerm)) || 
                (q.itemName && q.itemName.toLowerCase().includes(lowerCaseSearchTerm))
            );
            
            const displayQuotes = currentResultsLimit === 'all' ? filteredQuotes : filteredQuotes.slice(0, parseInt(currentResultsLimit));
            
            if (displayQuotes.length > 0) {
                noResultsMessage.style.display = 'none';
                renderHistoryTable(searchHistoryBody, displayQuotes, true);
            } else {
                searchHistoryBody.innerHTML = ''; noResultsMessage.textContent = 'No quotes found matching your search.'; noResultsMessage.style.display = 'block';
            }
        }

        function handleStatusChange(event, quoteId) {
            const newStatus = event.target.value; const selectElement = event.target;
            database.ref('quotes/' + quoteId).update({ status: newStatus })
                .then(() => {
                    selectElement.style.borderColor = '#28a745';
                    setTimeout(() => { selectElement.style.borderColor = '#d1d5db'; }, 1500);
                })
                .catch(error => {
                    console.error('Update failed:', error);
                    selectElement.style.borderColor = '#dc3545';
                    setTimeout(() => { selectElement.style.borderColor = '#d1d5db'; }, 2000);
                });
        }
        
        function openEditModal(quote) {
            const modal = document.getElementById('editModal');
            document.getElementById('editQuoteId').value = quote.id;
            const soldToSelect = document.getElementById('editSoldTo');
            soldToSelect.innerHTML = '';
            soldListCache.forEach(name => {
                const option = document.createElement('option');
                option.value = name; option.textContent = name;
                if (name === quote.sold) option.selected = true;
                soldToSelect.appendChild(option);
            });
            const outright = quote.outrightPrice ? quote.outrightPrice.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '';
            const exchange = quote.exchangePrice ? quote.exchangePrice.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '';
            document.getElementById('editOutrightPrice').value = outright;
            document.getElementById('editExchangePrice').value = exchange;
            document.getElementById('editStatus').value = quote.status;
            document.getElementById('editNotes').value = quote.notes || '';
            modal.classList.add('visible');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('visible');
        }

        async function handleEditFormSubmit() {
            const quoteId = document.getElementById('editQuoteId').value; if (!quoteId) return;
            const outrightPriceValue = document.getElementById('editOutrightPrice').value.replace(/,/g, '');
            const exchangePriceValue = document.getElementById('editExchangePrice').value.replace(/,/g, '');
            const updatedQuote = {
                sold: document.getElementById('editSoldTo').value,
                outrightPrice: outrightPriceValue ? parseFloat(outrightPriceValue) : null,
                exchangePrice: exchangePriceValue ? parseFloat(exchangePriceValue) : null,
                status: document.getElementById('editStatus').value,
                notes: document.getElementById('editNotes').value,
            };
            try {
                await database.ref('quotes/' + quoteId).update(updatedQuote);
                closeEditModal();
            } catch (error) {
                console.error("Error updating quote:", error);
                alert("Failed to update quote. See console for details.");
            }
        }

        async function handleDeleteQuote() {
            const quoteId = document.getElementById('editQuoteId').value; if (!quoteId) return;
            if (confirm("Are you sure you want to delete this quote permanently?")) {
                try {
                    await database.ref('quotes/' + quoteId).remove();
                    closeEditModal();
                } catch (error) {
                    console.error("Error deleting quote:", error);
                    alert("Failed to delete quote. See console for details.");
                }
            }
        }

        function renderSalesHistoryGraph(quotes) {
            const canvas = document.getElementById('salesHistoryChart');
            const noSalesDataMessage = document.getElementById('noSalesDataMessage');
            
            const soldQuotes = quotes
                .filter(q => q.status === 'Sold at Quoted Price Outright' || q.status === 'Sold at Quoted Price Exchange')
                .sort((a, b) => new Date(a.date) - new Date(b.date)); 

            if (soldQuotes.length === 0) {
                canvas.style.display = 'none';
                noSalesDataMessage.style.display = 'block';
                if (salesHistoryChart) {
                    salesHistoryChart.destroy();
                }
                return;
            }

            canvas.style.display = 'block';
            noSalesDataMessage.style.display = 'none';

            const labels = soldQuotes.map(q => new Date(q.date).toLocaleDateString());
            const outrightData = soldQuotes.map(q => q.status === 'Sold at Quoted Price Outright' ? q.outrightPrice : null);
            const exchangeData = soldQuotes.map(q => q.status === 'Sold at Quoted Price Exchange' ? q.exchangePrice : null);

            const data = {
                labels: labels,
                datasets: [
                    {
                        label: 'Outright Sale Price',
                        data: outrightData,
                        borderColor: '#2d7a7f',
                        backgroundColor: 'rgba(45, 122, 127, 0.1)',
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Exchange Sale Price',
                        data: exchangeData,
                        borderColor: '#f39237',
                        backgroundColor: 'rgba(243, 146, 55, 0.1)',
                        fill: false,
                        tension: 0.1
                    }
                ]
            };

            const config = {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            };
            
            if (salesHistoryChart) {
                salesHistoryChart.destroy();
            }
            salesHistoryChart = new Chart(canvas, config);
        }

        async function checkAndExpireQuotes() {
            const quotesRef = database.ref('quotes');
            const sevenDaysAgo = Date.now() - (7 * 24 * 60 * 60 * 1000);

            try {
                const snapshot = await quotesRef.orderByChild('status').equalTo('Quoted').once('value');
                if (snapshot.exists()) {
                    const updates = {};
                    snapshot.forEach(childSnapshot => {
                        const quote = childSnapshot.val();
                        const quoteDate = new Date(quote.date).getTime();

                        if (quoteDate < sevenDaysAgo) {
                            updates[`${childSnapshot.key}/status`] = 'Lost Sale';
                        }
                    });

                    if (Object.keys(updates).length > 0) {
                        await database.ref('quotes').update(updates);
                    }
                }
            } catch (error) {
                console.error("Error checking for expired quotes:", error);
            }
        }

        function handleCheckboxChange(event) {
            const checkbox = event.target;
            const quoteId = checkbox.dataset.quoteId;
            
            if (checkbox.checked) {
                selectedQuotes.add(quoteId);
            } else {
                selectedQuotes.delete(quoteId);
            }
            
            updateSelectedCount();
            updateSelectAllCheckbox();
        }

        function handleSelectAll(event) {
            const isChecked = event.target.checked;
            const checkboxes = document.querySelectorAll('.quote-checkbox');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = isChecked;
                const quoteId = checkbox.dataset.quoteId;
                
                if (isChecked) {
                    selectedQuotes.add(quoteId);
                } else {
                    selectedQuotes.delete(quoteId);
                }
            });
            
            updateSelectedCount();
        }

        function updateSelectAllCheckbox() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            const checkboxes = document.querySelectorAll('.quote-checkbox');
            const checkedBoxes = document.querySelectorAll('.quote-checkbox:checked');
            
            if (checkboxes.length === 0) {
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = false;
            } else if (checkedBoxes.length === checkboxes.length) {
                selectAllCheckbox.checked = true;
                selectAllCheckbox.indeterminate = false;
            } else if (checkedBoxes.length > 0) {
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = true;
            } else {
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = false;
            }
        }

        function updateSelectedCount() {
            const count = selectedQuotes.size;
            document.getElementById('selectedCount').textContent = count;
            document.getElementById('generatePdfButton').disabled = count === 0;
        }

        async function getNextQuoteNumber() {
            const counterRef = database.ref('quoteCounter');
            try {
                const snapshot = await counterRef.once('value');
                let currentNumber = snapshot.val() || 0;
                const newNumber = currentNumber + 1;
                await counterRef.set(newNumber);
                return `IMA_Q${newNumber}`;
            } catch (error) {
                console.error("Error generating quote number:", error);
                return `IMA_Q${Date.now()}`;
            }
        }

        async function generatePDF() {
            if (selectedQuotes.size === 0) {
                alert('Please select at least one quote to generate a PDF.');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const selected = allQuotesCache.filter(q => selectedQuotes.has(q.id));
            
            const hasOutright = selected.some(q => q.outrightPrice && !isNaN(parseFloat(q.outrightPrice)));
            const hasExchange = selected.some(q => q.exchangePrice && !isNaN(parseFloat(q.exchangePrice)));
            
            const quoteNumber = await getNextQuoteNumber();
            
            // Add logo in top right corner
            try {
                doc.addImage(IMED_LOGO_BASE64, 'PNG', 130, 5, 90, 45);
            } catch (e) {
                console.log("Logo not added:", e);
            }
            
            // Header
            doc.setFontSize(24);
            doc.setTextColor(0, 0, 0);
            doc.text('QUOTE', 20, 38);
            
            // Quote info
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text(`Quote Number: ${quoteNumber}`, 20, 48);
            doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, 54);
            
            // Calculate totals
            let totalOutright = 0;
            let totalExchange = 0;
            
            selected.forEach(quote => {
                if (quote.outrightPrice && !isNaN(parseFloat(quote.outrightPrice))) {
                    totalOutright += parseFloat(quote.outrightPrice);
                }
                if (quote.exchangePrice && !isNaN(parseFloat(quote.exchangePrice))) {
                    totalExchange += parseFloat(quote.exchangePrice);
                }
            });
            
            const headers = ['Date', 'PN', 'Item Name', 'Customer'];
            if (hasOutright) headers.push('Outright');
            if (hasExchange) headers.push('Exchange');
            
            const tableData = selected.map(quote => {
                const row = [
                    new Date(quote.date).toLocaleDateString(),
                    quote.pn || 'N/A',
                    quote.itemName || 'N/A',
                    quote.sold || 'N/A'
                ];
                
                if (hasOutright) {
                    row.push(formatPrice(quote.outrightPrice));
                }
                if (hasExchange) {
                    row.push(formatPrice(quote.exchangePrice));
                }
                
                return row;
            });
            
            const columnStyles = {
                0: { cellWidth: 25 },
                1: { cellWidth: 30 },
                2: { cellWidth: 40 },
                3: { cellWidth: 35 }
            };
            
            let colIndex = 4;
            if (hasOutright) {
                columnStyles[colIndex] = { cellWidth: 30 };
                colIndex++;
            }
            if (hasExchange) {
                columnStyles[colIndex] = { cellWidth: 30 };
            }
            
            doc.autoTable({
                startY: 44,
                head: [headers],
                body: tableData,
                theme: 'plain',  // Changed from 'striped' to 'plain' for more control
                headStyles: {
                    fillColor: [45, 122, 127],
                    textColor: [255, 255, 255],
                    fontSize: 10,
                    fontStyle: 'bold',
                    lineWidth: 0  // Remove header border
                },
                styles: {
                    fontSize: 9,
                    cellPadding: 4,
                    lineColor: [220, 220, 220],
                    lineWidth: 0,
                    fillColor: [240, 240, 240]  // Light gray for default rows
                },
                alternateRowStyles: {
                    fillColor: [220, 220, 220]  // Medium gray for alternating rows
                },
                columnStyles: columnStyles,
                margin: { left: 15, right: 15 },
                tableLineWidth: 0  // Remove outer table border
            });
            
            const finalY = doc.lastAutoTable.finalY;
            
            // Add totals with matching header style
            if (hasOutright && totalOutright > 0) {
                doc.setFillColor(45, 122, 127);
                doc.rect(15, finalY + 10, 180, 8, 'F');
                doc.setFontSize(12);
                doc.setTextColor(255, 255, 255);
                doc.setFont(undefined, 'bold');
                doc.text(`Total Outright Price: ${formatPrice(totalOutright)}`, 20, finalY + 16);
            }
            
            if (hasExchange && totalExchange > 0) {
                const yPos = (hasOutright && totalOutright > 0) ? finalY + 18 : finalY + 10;

                   // Add thin gray line separator if both totals exist
            if (hasOutright && totalOutright > 0) {
            doc.setDrawColor(200, 200, 200); // Light gray
            doc.setLineWidth(1.0);
            doc.line(15, finalY + 19, 195, finalY + 19);
            }
                
                doc.setFillColor(45, 122, 127);
                doc.rect(15, yPos, 180, 8, 'F');
                doc.setFontSize(12);
                doc.setTextColor(255, 255, 255);
                doc.setFont(undefined, 'bold');
                doc.text(`Total Exchange Price: ${formatPrice(totalExchange)}`, 20, yPos + 6);
            }
            
            doc.setFontSize(8);
            doc.setTextColor(150, 150, 150);
            doc.setFont(undefined, 'normal');
            doc.text('Page 1 of 2', doc.internal.pageSize.getWidth() / 2, doc.internal.pageSize.getHeight() - 10, { align: 'center' });
            
            // Page 2: Terms and Conditions
            doc.addPage();
            
            doc.setFontSize(16);
            doc.setTextColor(45, 122, 127);
            doc.setFont(undefined, 'bold');
            doc.text('Terms and Conditions', 105, 20, { align: 'center' });
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            doc.setFont(undefined, 'normal');
            
        const terms = [
            'TERMS AND CONDITIONS',
            '',
            'Terms in item entry supersede the following general terms.',
            '',
            'SHIPPING',
            'Shipping charges are not included. Shipping terms follow Incoterms 2020 (EXW Orange, California).',
            '',
            'INSURANCE',
            'Buyer is responsible for insuring the package and content.',
            '',
            'SALES',
            'Sales are final and for working genuine used parts. The customer is aware that the items purchased are in used condition and as such may show slight abrasion, scratches or discoloration.',
            '',
            'RESTOCKING',
            'If permitted by seller, items must be returned within 10 days. Buyer pays 25% restocking fee. Seller returns 75% upon return and testing of the restocked parts. Parts must be returned in working condition or the parts will not be accepted for restocking; customer will be responsible for 100% purchase price and shipping cost of the part back to customer.',
            '',
            '',
            'EXCHANGE SALE',
            'Exchange item needs to be returned prior to shipping of ordered parts unless otherwise agreed and stated, but in any case not later than 30 days. Exchange items must be repairable or outright sale applies.',
            '',
            'WARRANTY',
            '60 days from date of delivery.',
            '',
            'TAXES AND DUTIES',
            'The customer is responsible for all federal, state or local taxes, customs, or duties as they apply by governing agencies.',
            '',
            'PAYMENT',
            'Payment via bank transfer, direct deposit or secured check. Credit card payments incur an additional 3% processing fee.',
            '',
            'Mail checks to:',
            'iMed All, Inc.',
            '751 S Weir Canyon Rd, Ste 157-521',
            'Anaheim, CA 92808',
            ''
        ];
            
            let yPosition = 35;
            const lineHeight = 6;
            const pageHeight = doc.internal.pageSize.getHeight();
            const bottomMargin = 20;
            
            terms.forEach(line => {
                if (yPosition > pageHeight - bottomMargin) {
                    doc.addPage();
                    yPosition = 20;
                }
                
                doc.text(line, 15, yPosition, { maxWidth: 180 });
                yPosition += lineHeight;
            });
            
            doc.setFontSize(8);
            doc.setTextColor(150, 150, 150);
            doc.text('Page 2 of 2', doc.internal.pageSize.getWidth() / 2, doc.internal.pageSize.getHeight() - 10, { align: 'center' });
            
            const fileName = `iMED_Quote_${quoteNumber}.pdf`;
            doc.save(fileName);
        }
    </script>
</body>
</html>
